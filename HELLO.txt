CREATE PROC UPDATE_REPORT(@ID bigint,@emStarDate date,@emEndDate date,@emTechnicianNote nvarchar(200)) 
AS
BEGIN
    UPDATE EmergencyMaintenances
    SET EMStartDate=@emStarDate,
        EMEndDate=@emEndDate,
        EMTechnicianNote=@emTechnicianNote
    WHERE ID=@ID
END

GO
--
CREATE PROC DeletePart(@id bigint)
AS
BEGIN
 DELETE ChangedParts
 WHERE ID= 4
END
--
GO

CREATE PROC SELECT_ALL_EM
AS
BEGIN
SELECT B.ID, A.AssetSN, A.AssetName, B.EMReportDate, 
(SELECT FirstName + ' ' + LastName FROM Employees WHERE ID= A.EmployeeID) AS'Employee Full Name',
(SELECT D.NAME FROM DepartmentLocations C, Departments D WHERE C.DepartmentID= D.ID AND A.DepartmentLocationID= C.ID) AS'Department'
FROM Assets A, EmergencyMaintenances B
WHERE A.ID= B.AssetID AND B.EMEndDate IS NULL
END
--Lay du lieu cho detail part
GO 

CREATE PROC GetAllChangedPart(@id bigint)
AS
BEGIN
 SELECT B.ID, A.Name, B.Amount
 FROM Parts A, ChangedParts B
 WHERE A.ID= B.PartID AND B.EmergencyMaintenanceID= @id
END
